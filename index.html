<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>Redoxify Dataloader</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Introduction";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
 <link href="assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="assets/javascripts/glightbox.min.js"></script></head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> Redoxify Dataloader
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Introduction</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#features">Features</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="transforms/">Transforms</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">Redoxify Dataloader</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p><a id="readme-top"></a></p>
<p><br /></p>
<div align="center">

<h3 align="center">Redoxify</h3>

  <p align="center">
   NVIDIA DALI-based data loader integrated into your favorite DL frameworks (such as mmdetection).
  </p>
</div>

<h2 id="about-the-project">About The Project</h2>
<p>Redoxify leverages the NVIDIA DALI (Data Loading Library) framework to create a highly efficient data loader for deep learning tasks, specifically designed for use with PyTorch. The goal is to minimize the time spent on data loading and augmentation, allowing users to focus more on model training. With Redoxify, users can generate a complete DALI-based dataloader pipeline using only a configuration file, making it easy to use DALI without needing to understand its complexities.</p>
<h3 id="features">Features</h3>
<ul>
<li><strong>Configuration-Driven Pipelines</strong>: Generate a complete data loading and augmentation pipeline using a simple configuration file.</li>
<li><strong>GPU and CPU Support</strong>: Data loading and augmentation can be performed on both GPU and CPU.</li>
<li><strong>Efficient Data Loading</strong>: Rapid data reading from files directly into GPU memory.</li>
<li><strong>Seamless Data Augmentation</strong>: Various augmentation operations are applied directly on the GPU, significantly reducing preprocessing time.</li>
<li><strong>Integration with PyTorch</strong>: Easy integration with PyTorch for seamless data processing and training.</li>
<li><strong>User-Friendly</strong>: No need to write complex DALI code; simply provide a configuration file.</li>
</ul>
<p><em>For details, please refer to the [Documentation]</em></p>
<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- GETTING STARTED -->
<h2 id="getting-started">Getting Started</h2>
<h3 id="installation">Installation</h3>
<p>To install Redoxify, follow these steps:</p>
<ol>
<li>
<p>Install the required dependencies:</p>
<ul>
<li>pytorch &lt;=2.3.0, &gt;=1.9.0</li>
<li>for CUDA 11.0:<br />
<code>pip install --extra-index-url https://pypi.nvidia.com --upgrade nvidia-dali-cuda110</code></li>
<li>for CUDA 12.0:<br />
<code>pip install --extra-index-url https://pypi.nvidia.com --upgrade nvidia-dali-cuda120</code></li>
</ul>
</li>
<li>
<p>Clone this repository:<br />
<code>sh
    git clone &lt;repository-url&gt;
    cd &lt;repository-directory&gt;</code></p>
</li>
</ol>
<h3 id="usage">Usage</h3>
<p>Here's an very simple example of how to use Redoxify in your project:<br />
1. <strong>Create a Configuration File(a .py file)</strong></p>
<pre><code>```python
tf_feature_spec = {
        "image": tfrec.FixedLenFeature((), tfrec.string, ""),
        "labels": tfrec.VarLenFeature(tfrec.int64, -1),
        "bboxes": tfrec.VarLenFeature(tfrec.float32, 0.0),
    }
datablock_spec = {
    "image": ImageSpec(encoding='jpg',channel=3),
    "labels": VectorSpec(dtype=DALIDataType.INT64),
    "bboxes": BoxSpec(),
}
record_files = sorted(glob.glob("/path/to/your/records/*record*"))
index_files = sorted(glob.glob("/path/to/your/records/*index*"))
tf_files = [TFRecordFile(record_file=rec_file, index_file=idx_file) for rec_file, idx_file in zip(record_files, index_files)]
reader_cfg = TFReaderConfig(tf_feature_spec=tf_feature_spec, datablock_spec=datablock_spec, random_shuffle=True)

image_crop_setting = ImageCropSetting(image_key=DataKey("image"), output_key=DataKey("image"))
labels_crop_setting = LabelCropSetting(ref_box_key=DataKey("bboxes",), crop_box_key=DataKey("bboxes"),
                                crop_label_key=DataKey("labels"),
                                output_box_key=DataKey("bboxes"), output_label_key=DataKey("labels"))
crop_map = CropInputOutputMap(image_crop_settings=[image_crop_setting], label_crop_settings=[labels_crop_setting])
crop_cfg = CropConfig(aspect_ratio_wh_min=0.5, aspect_ratio_wh_max=2.0, box_length_min=0.5, box_length_max=1.0)
crop_cfg._all_boxes_above_threshold = False

image_resize_setting = ImageResizeSetting(image_key=DataKey("image"), output_key=DataKey("image"))
box_resize_setting = BoxResizeSetting(box_key=DataKey("bboxes"), output_key=DataKey("bboxes"))
resize_map = ResizeInputOutputMap(image_resize_settings=[image_resize_setting], box_resize_settings=[box_resize_setting])
resize_cfg = ResizeConfig(target_height=640, target_width=640, keep_aspect_ratio=True, keep_aspect_ratio_mode='not_larger')

output_map = dict(
    images=SingleOutputSpec(input_key=DataKey("image"), pad_for_batch=True, split_batch_into_list=True),
    bboxes=SingleOutputSpec(input_key=DataKey("bboxes"), pad_for_batch=True, split_batch_into_list=True),
    classes=SingleOutputSpec(input_key=DataKey("labels"), pad_for_batch=True, split_batch_into_list=True)
)

redox_loader_config = dict(
    pipeline_cfg=dict(
        batch_size=8,
        num_workers=8,
    ),
    reader=dict(
        tf_files=tf_files,
        reader_cfg=reader_cfg,
        do_not_split_tfrec=False,
    ),
    transform_sequence=[
        dict(
            type='RandomCropWithBoxes',
            config=crop_cfg,
            inout_map=crop_map
        ),
        dict(
            type='Resize',
            config=resize_cfg,
            inout_map=resize_map
        )
    ],
    output_map=output_map,
)
```
</code></pre>
<ol>
<li><strong>Load the Configuration and Initialize the Data Loader</strong><br />
We provide a base class <code>redoxify.datasets.RedoxBaseDataset</code> to read data according to the configuration file. You can inherit from the RedoxBaseDataset class to define a new dataset according to your needs. We provide <code>redoxify.plugin.mmdetection.datasets.RedoxMMDetDataset</code> as an example. RedoxMMDetDataset can directly replace the dataset in the mmdetection framework, but you need to use the collate function in <code>redoxify.plugin.mmdetection.datasets.utils</code>. The sample code is in ./tests/test_dataset.py.</li>
</ol>
<h2 id="customization">Customization</h2>
<p>Redoxify allows you to define your data augmentation pipeline through a configuration file. You can add, remove, or modify the augmentation operations as needed. DALI provides a wide range of operations that can be used in your pipeline, such as:</p>
<ul>
<li>Image Resizing</li>
<li>Normalization</li>
<li>Cropping</li>
<li>Color Adjustments</li>
<li>Random Augmentations</li>
</ul>
<p>Refer to the documentation for more details on the available operations and their usage.</p>
<h2 id="contributing">Contributing</h2>
<p>We welcome contributions to enhance this project. Feel free to submit issues and pull requests on GitHub.</p>
<h2 id="license">License</h2>
<p>This project is licensed under the Apache License 2.0. See the LICENSE file for details.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<ul>
<li>NVIDIA DALI for providing an excellent library for efficient data loading and augmentation.</li>
</ul>
<h2 id="contact">Contact</h2>
<p>For any questions or inquiries, please contact</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="transforms/" class="btn btn-neutral float-right" title="Transforms">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="transforms/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body>
</html>

<!--
MkDocs version : 1.6.0
Build Date UTC : 2024-09-05 10:06:17.103372+00:00
-->
